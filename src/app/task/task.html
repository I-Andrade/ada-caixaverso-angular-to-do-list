<div
  class="
    flex flex-wrap sm:flex-nowrap
    justify-between items-center
    rounded-lg
    shadow-md shadow-blue-100
    px-2 py-1 mb-1 
    transition-all duration-500"
  [ngClass]="{
    'bg-blue-700 text-white': task.completed,
    'bg-white text-gray-900': !task.completed && !editing && !adding,
    'bg-slate-200 text-gray-900 animate-pulse': !task.completed && editing,
    'bg-stone-200 text-gray-900 animate-pulse': !task.completed && adding,
  }"
>
  <!-- Existing task -->
  <ng-container *ngIf="task.title != undefined">
    <div class="w-full flex flex-wrap gap-1 sm:flex-nowrap items-center">
      <!-- Checkbox for task completion -->
      <input
        type="checkbox"
        [checked]="task.completed"
        (click)="toggleTask(task.id)"
      />

      <!-- Input field for task title -->
      <input
        #taskInput
        type="text"
        placeholder="Edit a task"
        class="flex-grow p-1 text-lg cursor-pointer focus-visible:rounded-2xl"
        [class.line-through]="task.completed"
        [class.text-blue-500]="editing"
        [value]="editing ? newTitle : task.title"
        (input)="newTitle = taskInput.value"
        [disabled]="!editing"
        [readOnly]="!editing"
        [autofocus]="editing"
        (keyup.enter)="editing ? editTask(task.id, newTitle) : null"
        (keyup.esc)="editing = false"
      />

      <!-- Buttons -->
      <div class="flex flex-wrap gap-1 justify-end sm:flex-nowrap items-center">
        <ng-container *ngIf="task.completed"><span class="font-bold text-green-500">OK</span></ng-container>
        <ng-container *ngIf="!editing && !task.completed">
          <button
            (click)="markAsEditing(taskInput)"
            class="cursor-pointer text-blue-500 hover:text-blue-700"
          >
            Edit
          </button>
          <button
            (click)="deleteTask(task.id)"
            class="cursor-pointer text-red-500 hover:text-red-700"
          >
            Delete
          </button>
        </ng-container>
        <ng-container *ngIf="editing && !task.completed">
          <button
            (click)="editing = false"
            class="cursor-pointer text-red-500 hover:text-red-700"
          >
            Cancel
          </button>
          <button
            (click)="!newTitle.trim() ? null : editTask(task.id, newTitle)"
            [disabled]="!newTitle.trim()"
            [ngClass]="{
              'text-green-500 hover:text-green-700 cursor-pointer': newTitle.trim().length,
              'text-gray-500 cursor-not-allowed': !newTitle.trim()
            }"
          >
            Save
          </button></ng-container
        >
      </div>
    </div>
  </ng-container>

  <!-- New task -->
  <ng-container *ngIf="task.title == undefined">
    <div class="w-full flex flex-wrap gap-1 sm:flex-nowrap items-center">
      
      <!-- Checkbox disabled for task completion -->
      <input type="checkbox" [checked]="false" [disabled]="true"/>

      <!-- Input field for task title -->
      <input
        #newTaskInput
        type="text"
        placeholder="Add a new task"
        class="flex-grow p-1 text-lg cursor-pointer focus-visible:rounded-2xl text-orange-500"
        (input)="newTitle = newTaskInput.value"
        (focus)="adding = true"
        (keyup.enter)="addTask(newTitle)"
        (keyup.esc)="
          adding = false; newTaskInput.value = ''; newTaskInput.blur()
        "
      />

      <!-- Buttons -->
      <div class="flex flex-wrap gap-1 justify-end sm:flex-nowrap items-center">
      <button
        *ngIf="!adding"
        (click)="markAsAdding(newTaskInput)"
        class="cursor-pointer text-blue-500 hover:text-blue-700"
      >
        Add
      </button>
      <ng-container *ngIf="adding">
         <button
            (click)="adding = false; newTaskInput.value = ''"
            class="cursor-pointer text-red-500 hover:text-red-700"
          >
            Cancel
          </button>
          <button
        
        (click)="!newTitle.trim() ? null : addTask(newTitle)"
        [disabled]="!newTitle.trim()"
        [ngClass]="{
          'text-green-500 hover:text-green-700 cursor-pointer':
            newTitle.trim().length,
          'text-gray-500 cursor-not-allowed': !newTitle.trim()
        }"
      >
        Save
      </button>
      </ng-container>
      
    </div>
    </div>

    
  </ng-container>
</div>
